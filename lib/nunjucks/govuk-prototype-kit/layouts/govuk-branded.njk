{%- set assetPath = assetPath | default('/plugin-assets/govuk-frontend' + govukFrontend.assetPath) -%}

{% extends "govuk/template.njk" %}

{# 
  Import ServiceNavigation for when the Kit runs and GOV.UK Frontend is
  uninstalled. In that situation, it loads the Page template from GOV.UK
  Frontend used by the management pages. The version used by the management
  pages predates when we added the Service Navigation to the page template, so
  we need to import it explicitly.
  
  TODO: Remove once the management pages run GOV.UK Frontend 6.0.0
#}
{% from "govuk/components/service-navigation/macro.njk" import govukServiceNavigation %}

{% block head %}
  {% block meta %}{% endblock %}
  {% block stylesheets %}
    {% include "govuk-prototype-kit/includes/stylesheets.njk" %}
  {% endblock %}
{% endblock %}

{% block pageTitle %}
  {% if pageName %}{{ pageName }} - {% endif %}{{ serviceName }} - GOV.UK
{% endblock %}

{% block header %}
  {% if pluginVersionSatisfies('govuk-frontend', '>=6.0.0') %}
    {{ super() }}
  {% else %}
    {{ govukHeader({
      homepageUrl: "/",
      serviceName: serviceName if not useServiceNavigation,
      serviceUrl: serviceUrl if not useServiceNavigation,
      containerClasses: "govuk-width-container"
    }) }}
    {% if useServiceNavigation %}
      {{
        govukServiceNavigation({
          serviceName: serviceName,
          serviceUrl: serviceUrl
        })
      }}
    {% endif %}
  {% endif %}
{% endblock %}

{% if (GOVUKPrototypeKit.isDevelopment) %}
  {% set footerItems = [
    {
      href: "/manage-prototype",
      text: "Manage your prototype"
    }, {
      href: "/manage-prototype/clear-data",
      text: "Clear data"
    }
  ] %}
{% else %}
  {% set footerItems = [
    {
      href: "/manage-prototype/clear-data",
      text: "Clear data"
    }
  ] %}
{% endif %}

{# 
  Because the macro is used inside `set` rather than a `block`
  `govukFooter` needs to be explicitely imported
#}
{% from 'govuk/components/footer/macro.njk' import govukFooter %}
{% set govukFooterHtml %}
  {{ govukFooter({
    meta: {
      items: footerItems,
      visuallyHiddenTitle: "Footer links"
    }
  }) }}
{% endset %}

{# Override only the GOV.UK Footer component for GOV.UK Frontend >=6.0.0 #}
{% block govukFooter %}{{govukFooterHtml | safe}}{% endblock %}

{% block footer %}
  {% if pluginVersionSatisfies('govuk-frontend', '>=6.0.0') %}
    {{ super() }}
  {% else %}
    {{govukFooterHtml | safe }}
  {% endif %}
{% endblock %}

{% block bodyEnd %}
  {% block scripts %}
    {% include "govuk-prototype-kit/includes/scripts.njk" %}
    {% block pageScripts %}{% endblock %}
  {% endblock %}
{% endblock %}
